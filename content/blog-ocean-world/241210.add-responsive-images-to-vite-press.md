---
title: VitePress ä¹‹æ‰€ä»¥æˆ‘èªªé‚£å€‹éŸ¿æ‡‰å¼åœ–ç‰‡å‘¢ï¼Ÿ
description: VitePress æ²’æœ‰ Nuxt Image é‚£æ¨£æ–¹ä¾¿ä¸”è‡ªå‹•çš„åœ–ç‰‡è™•ç†ï¼Œè©²æ€éº¼è¾¦å‘¢ï¼Ÿáƒš(ãƒ»Â´ï½ª`ãƒ»áƒš)
tags: ['VitePress']
image: https://codlin.me/add-responsive-images-to-vite-press.webp
date: 20241210
---

# VitePress ä¹‹æ‰€ä»¥æˆ‘èªªé‚£å€‹éŸ¿æ‡‰å¼åœ–ç‰‡å‘¢ï¼Ÿ

![add-responsive-images-to-vite-press](/add-responsive-images-to-vite-press.webp){.cover}

æ­¤éƒ¨è½æ ¼åŸæœ¬ä½¿ç”¨ Nuxt Content é–‹ç™¼ï¼Œä½†æ˜¯å› ç‚º Nuxt Content æŠŠæ–‡ç« ä¹Ÿç®—åœ¨ Server è³‡æºå…§ï¼Œå°è‡´ç·¨è­¯å¾Œå°ºå¯¸è¶…é Cloudflare Workers ä¸Šé™ã€‚

~~é ¹å»¢~~æ“±ç½®å¥½é•·ä¸€æ®µæ™‚é–“å¾Œï¼Œæœ€è¿‘çµ‚æ–¼æœ‰æ™‚é–“æ”¹ç”¨ VitePress é‡æ§‹äº†ã€‚

ä¸é VitePress æ²’æœ‰ [Nuxt Image](https://image.nuxt.com) å¯ä»¥è‡ªå‹•è™•ç†[éŸ¿æ‡‰å¼åœ–ç‰‡](https://web.dev/articles/responsive-images)ï¼Œæ‰‹å‹•è™•ç†å¯¦åœ¨æ˜¯è¦é­šå‘½ã€‚<span class="text-nowrap">...(â€ºÂ´Ï‰`â€¹ )</span>

èº«ç‚ºä¸€å€‹ç¨±è·çš„ç¢¼è¾²ï¼Œç•¶ç„¶è¦è‡ªå‹•è™•ç†å•Šã€‚<span class="text-nowrap">â(ãƒ»Ï‰Â´ãƒ»â)</span>

çµæœæ‰¾ä¸åˆ°é©åˆã€ç¾æˆçš„å¤–æ›ï¼Œåªå¥½è‡ªå·±æƒ³è¾¦æ³•äº†ã€‚<span class="text-nowrap">áƒš(ãƒ»Â´ï½ª`ãƒ»áƒš)</span>

å¦‚æœå¤§å¤§å€‘æœ‰æ›´å¥½çš„è§£æ³•ï¼Œ~~è«‹ä¸è¦å‘Šè¨´æˆ‘ï¼Œæˆ‘å·²ç¶“åšå®Œäº†~~ï¼Œèªªèªªçš„å•¦ï¼Œé‚„æ˜¯å‘Šè¨´æˆ‘å¥½äº†ã€‚<span class="text-nowrap">(*Â´âˆ€`)~â™¥</span>

::: tip
æœ¬æ–‡ä¸æ˜¯ VitePress å…¥é–€æ•™å­¸ï¼Œä¸æœƒä»‹ç´¹ VitePress çš„åŸºæœ¬ç”¨æ³•ã€‚<span class="text-nowrap">( Â´ â–½ ` )ï¾‰</span>

è‹¥æœ‰éœ€è¦ï¼Œå¯ä»¥åƒè€ƒæ­¤ç³»åˆ—æ–‡ï¼š[30å¤©ç”¨Vitepress é–‹å•Ÿæˆ‘çš„"éƒ¨è½å®¢"ç”Ÿæ´»](https://ithelp.ithome.com.tw/users/20109918/ironman/7545)ã€‚
:::

## ä½•è¬‚éŸ¿æ‡‰å¼åœ–ç‰‡ï¼Ÿ

éŸ¿æ‡‰å¼åœ–ç‰‡æ˜¯æŒ‡æ ¹æ“šè£ç½®è§£æåº¦ï¼Œæä¾›ä¸åŒå°ºå¯¸çš„åœ–ç‰‡ï¼Œä»¥é”åˆ°æœ€ä½³çš„ä½¿ç”¨è€…é«”é©—ã€‚

ä¾‹å¦‚ï¼šæ‰‹æ©Ÿè§£æåº¦è¼ƒä½ï¼Œå°±ä¸éœ€è¦è¼‰å…¥é«˜è§£æåº¦çš„åœ–ç‰‡ï¼Œä»¥ç¯€çœæµé‡ã€‚

è©³ç´°å…§å®¹æ¨è–¦çœ‹çœ‹é€™ç¯‡æ–‡ç« ï¼š[Responsive images](https://web.dev/responsive-images)ã€‚

## è§£æ±ºæ–¹æ¡ˆ

æœå°‹ã€ç ”ç©¶äº†ä¸€ä¸‹ï¼Œç›®å‰ç¸½çµå‡ºä¾†çš„æ­¥é©Ÿç‚ºï¼š

1. å»ºç«‹ä¸€å€‹ç”¢ç”ŸéŸ¿æ‡‰å¼åœ–ç‰‡çš„è…³æœ¬
1. åœ¨ [`buildEnd`](https://vitepress.dev/reference/site-config#buildend) éšæ®µåŸ·è¡Œè…³æœ¬
1. æ“´å±• markdown-itï¼Œå°‡ image æ¨™ç±¤æ›¿æ›ç‚ºè‡ªå®šç¾© Vue å…ƒä»¶ï¼ˆ`base-image`ï¼‰
1. é–‹ç™¼ `base-image` å…ƒä»¶ï¼Œç”¢ç”Ÿç´„å®šå¥½çš„åœ–ç‰‡å°ºå¯¸ä¹‹ srcset å±¬æ€§

æ–¹å‘æœ‰äº†ï¼Œç¾åœ¨ä¾†å¯¦ä½œå§ï¼<span class="text-nowrap">â—( â€¢Ï‰â€¢ )â—Ÿ</span>

### ç”¢ç”ŸéŸ¿æ‡‰å¼åœ–ç‰‡

é€™å€‹éƒ¨åˆ†å¾ˆå–®ç´”ï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯å–å¾—æ‰€æœ‰åœ–ç‰‡å¾Œï¼Œä½¿ç”¨ [sharp](https://www.npmjs.com/package/sharp) ç”¢ç”Ÿåœ–ç‰‡

<<< ../../.vitepress/scripts/resize-images.ts

### åŸ·è¡Œè…³æœ¬

ä¾ç…§ [VitePress æ–‡ä»¶](https://vitepress.dev/reference/site-config#build-hooks)èªªæ³•ï¼Œ`.vitepress\config.mts` ä¸­æœ‰å¤šå€‹ Build Hooks å¯ä»¥è¨­å®šã€‚

ç”±æ–¼æˆ‘åªè¦å»ºæ§‹å¾Œç”¢ç”Ÿï¼Œæ‰€ä»¥åœ¨ `buildEnd` éšæ®µåŸ·è¡Œå³å¯ã€‚

`.vitepress\config.mts`

```ts
import { generateImages } from './scripts/resize-images'

// https://vitepress.dev/reference/site-config
export default ({ mode }) => {
  return defineConfig({
    // ...
    async buildEnd() {
      await generateImages()
    },
  })
}
```

ç¾åœ¨è®“æˆ‘å€‘è©¦è©¦ build å¾Œæœƒä¸æœƒè·‘å‡ºå„ç¨®å°ºå¯¸çš„åœ–ç‰‡ã€‚<span class="text-nowrap">(Â´ãƒ»Ï‰ãƒ»`)</span>

åŸ·è¡Œ build å¾Œï¼Œæ²’æœ‰æ„å¤–çš„è©±ï¼Œæ‡‰è©²è¦å‡ºç¾ä»¥ä¸‹æ–‡å­—ã€‚

```shell
  vitepress v1.5.0

âœ“ building client + server bundles...
âœ“ rendering pages...
âœ“ generating sitemap...
[ generateImages ] æ‰¾åˆ° 43 å¼µåœ–ç‰‡
[ generateImages ] ç”¢ç”Ÿå®Œæˆ
build complete in 11.75s.
```

ä¸” dist è³‡æ–™å¤¾å…§æ‡‰è©²è¦è·‘å‡ºå„ç¨®å°ºå¯¸çš„åœ–ç‰‡ã€‚

![generate-rwd-image](/add-responsive-images-to-vite-press/generate-rwd-image.jpg)

åœ–ç‰‡å‡ºç¾äº†ï¼<span class="text-nowrap">â—(â‰§âˆ€â‰¦)â—Ÿ</span>

### æ“´å±• markdown-it

[`config.mts` ä¸­æœ‰ä¿ç•™æ¬„ä½](https://vitepress.dev/guide/markdown#advanced-configuration)ï¼Œå¯ä»¥è¨­å®šè‡ªè¡Œæ‹“å±• markdown-it åŠŸèƒ½ã€‚

æ–°å¢ä¸€å€‹ markdown-it å¤–æ›ï¼ŒåŠŸèƒ½å¾ˆå–®ç´”ï¼Œå°±æ˜¯å°‡ markdown ä¸­çš„ `img` æ¨™ç±¤æ›¿æ›ç‚º `base-image` å…ƒä»¶ã€‚

<<< ../../.vitepress/plugin/markdown-it-base-img.ts

### é–‹ç™¼å…ƒä»¶

æœ€å¾Œä¹Ÿæ˜¯æœ€é‡è¦çš„ä¸€æ­¥ï¼Œé–‹ç™¼ `base-image` å…ƒä»¶ä¸¦ç”¢ç”Ÿ srcset å±¬æ€§ã€‚

<<< ../../components/base-img.vue

æ¥è‘—å°‡ `base-image` è¨»å†Šç‚ºå…¨åŸŸå…ƒä»¶ã€‚

`.vitepress\theme\index.ts`

```ts
import type { Theme } from 'vitepress'
// https://vitepress.dev/guide/custom-theme
import BaseImg from '../../components/base-img.vue'

export default {
  // ...
  enhanceApp({ app, router, siteData }) {
    app.component('BaseImg', BaseImg)
  },
} satisfies Theme
```

## å¯¦æ¸¬

ç¾åœ¨è®“æˆ‘å€‘åŸ·è¡Œ `vitepress preview`ï¼Œä¾†è©¦è©¦çœ‹æ•ˆæœå¦‚ä½•å§ã€‚

![rwd-result](/add-responsive-images-to-vite-press/rwd-result.jpg)

å¯ä»¥æ³¨æ„åˆ°åŸæœ¬çš„ `img` æ¨™ç±¤å·²æ›¿æ›ç‚º `picture` æ¨™ç±¤ï¼ˆ`base-image` å…ƒä»¶ï¼‰ï¼Œä¸¦ä¸”ç”¢ç”Ÿäº† `srcset` å±¬æ€§ã€‚

å¤§åŠŸå‘Šæˆï¼<span class="text-nowrap">à©­ Ë™á—œË™ )à©­</span>

## ç¸½çµ ğŸŸ

- ä½¿ç”¨ [sharp](https://www.npmjs.com/package/sharp) ç”¢ç”Ÿå¤šç¨®å°ºå¯¸åœ–ç‰‡
- æ“´å±• markdown-itï¼Œå°‡ image æ¨™ç±¤æ›¿æ›ç‚ºè‡ªå®šç¾© Vue å…ƒä»¶ï¼ˆ`base-image`ï¼‰
- è—‰ç”± `base-image` å…ƒä»¶ç”¢ç”Ÿç´„å®šå¥½çš„åœ–ç‰‡å°ºå¯¸ä¹‹ srcset å±¬æ€§

<br>

ä»¥ä¸Šæˆ‘å€‘å®Œæˆè‡ªå‹•ç”¢ç”Ÿã€æ›¿æ›éŸ¿æ‡‰å¼åœ–ç‰‡çš„åŠŸèƒ½äº†ï¼<span class="text-nowrap">âœ§â‘ï½¡Ù©(ËŠá—œË‹*)Ùˆâœ§â•ï½¡</span>

å…¶å¯¦é‚„æœ‰å¾ˆå¤šç´°ç¯€å¯ä»¥è™•ç†ï¼Œä¾‹å¦‚ï¼šå¦‚æœåœ–ç‰‡å°æ–¼ç›®æ¨™å°ºå¯¸ï¼Œå°±ä¸éœ€è¦ç”¢ç”Ÿæ–°åœ–ç‰‡ç­‰ç­‰ã€‚

æˆ‘å°±ä¸å‰å¥ªå…¶ä»–äººå¯¦é©—çš„æ©Ÿæœƒäº†ï¼Œç•™çµ¦å¤§å¤§å€‘è‡ªå·±å˜—è©¦æƒ¹ã€‚

è¦æ”¹å¾—å¤ªå¤šæƒ¹ï¼Œæˆ‘æ±ºå®šæ”¹å¤©ï¼á••( ï¾Ÿ âˆ€ã€‚)á•—
