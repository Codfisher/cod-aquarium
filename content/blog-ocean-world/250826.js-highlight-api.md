---
description: 在 JavaScript 實作網頁文字搜尋關鍵字的 highlight 效果
tags: ['Vue', 'JavaScript']
image: https://codlin.me/js-highlight-api.webp
date: 20250826
---

<script setup>
  import FilterTable from './js-highlight-api/filter-table.vue'
  import TextHighlight from './js-highlight-api/text-highlight.vue'
  import HighlightTable from './js-highlight-api/highlight-table.vue'
</script>

![js-highlight-api](/js-highlight-api.webp){.cover}

# 越暗的地方你越亮，透過 JS 把關鍵字標示出來吧

製作關鍵字篩選的功能常常在想，如果能像瀏覽器內建的關鍵字搜尋功能那樣，把符合的關鍵字標示出來，使用體驗應該會更好。

研究了一輪，發現還真的可以做到，讓我們一步一步實作吧！%( ´ ▽ ` )ﾉ%

## 關鍵字過濾

首先讓我們做一個基本的 table 元件，讓使用者可以輸入關鍵字來篩選資料。

<filter-table />

可以看到當我們輸入關鍵字時，table 會自動篩選出符合的資料。

如果能夠再把符合的關鍵字標示出來，可以大幅提升使用體驗。%( •̀ ω •́ )✧%

所以應該怎麼做呢？將關鍵字使用 `<mark>` 標籤包起來嗎？

這的確是最經典的做法，但現在有更容易的方法了！%( ‧ω‧)ノ╰(‧ω‧ )%

## Highlight API

現在可以使用 [Highlight API](https://developer.mozilla.org/en-US/docs/Web/API/Highlight) 實現！%─=≡Σ((( つ•̀ω•́)つ%

不過目前（2025/08/26）支援度為「Baseline 2025 Newly available」，如果有舊瀏覽器需求，就只能乖乖回去用 `<mark>` 標籤了。%( ˘･з･)%

所以該怎麼使用呢？概念為：

1. 取得要標記的文字目標 DOM
1. 使用 `Range` 設定標記範圍
1. 使用這個 `Range` 建立一個 `Highlight` 物件。
1. 將這個 `Highlight` 物件透過 CSS.highlights.set 註冊到瀏覽器，並指定名稱為 `'my-custom-highlight'`。
1. 設定 `::highlight(my-custom-highlight)` 樣式內容

以下是範例程式：

`content\blog-ocean-world\js-highlight-api\text-highlight.vue`

<<< ./js-highlight-api/text-highlight.vue

實際效果如下：

<text-highlight />

可以注意到文字不需要被 `<mark>` 包起來，Highlight API 會自動幫我們把符合的關鍵字標示出來。

這樣就不用調整 HTML 結構了，是不是很方便啊！%∠( ᐛ 」∠)_%

## 來個封裝

知道怎麼用了，現在讓我們把這個功能一下，使用上更方便。

<<< ../../composables/use-text-highlight.ts

把此功能加入剛剛做的 table 中。

`content\blog-ocean-world\js-highlight-api\highlight-table.vue`

<<< ./js-highlight-api/highlight-table.vue

現在不只可以過濾時會標記關鍵字，還可以自由調整標示顏色！%◝(≧∀≦)◟%

<highlight-table />

## 總結 🐟

- 標示相符的關鍵字，可以提升使用者體驗
- 使用 Highlight API 可以更方便地實現文字標記效果
- 封裝成 `useTextHighlight`，可以在不同場景中重複使用
