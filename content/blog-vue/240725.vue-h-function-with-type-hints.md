---
title: æ‰€ä»¥æˆ‘èªªé‚£å€‹å‹åˆ¥å‘¢ï¼Ÿä¾†ä¸€å€‹æœ‰å½¢åˆ¥æç¤ºçš„ Vue h function å§ï¼
description: å…ˆå‰æåˆ° Quasar çš„ Dialog Plugin å¾ˆå¥½ç”¨ï¼Œå†è®“æˆ‘è£œå……ä¸€å€‹ç”¨æ³•ã€‚áƒš(â•¹â—¡â•¹áƒš)
tags: ['Vue', 'Quasar', 'TypeScript']
image: https://codlin.me/vue-h-function-with-type-hints.webp
date: 20240725
---

![vue-h-function-with-type-hints](/vue-h-function-with-type-hints.webp){.cover}

# æ‰€ä»¥æˆ‘èªªé‚£å€‹å‹åˆ¥å‘¢ï¼Ÿä¾†ä¸€å€‹æœ‰å½¢åˆ¥æç¤ºçš„ Vue h function å§ï¼

[å…ˆå‰æåˆ°](./blog-vue/vue-h-function-makes-quasar-dialog-easier-to-reuse) Quasar çš„ Dialog Plugin å¾ˆå¥½ç”¨ï¼Œå†è®“æˆ‘è£œå……ä¸€å€‹ç”¨æ³•ã€‚

æœ‰æ™‚å€™æœƒå¸Œæœ›å¯ä»¥é»æ“Šåœ–ç‰‡æ™‚å°‡åœ–ç‰‡æœ€å¤§åŒ–å‘ˆç¾ï¼Œé€™å€‹éœ€æ±‚å¦‚æœè¦ç°¡å–®å¯¦ç¾ï¼Œå¯ä»¥ä½¿ç”¨ QDialog å¯¦ä½œã€‚

æœ€ç›´æ¥çš„åšæ³•æ‡‰è©²æ˜¯é»æ“ŠæŒ‡å®šåœ–ç‰‡æ™‚ï¼Œå°‡åœ–ç‰‡çš„ src å­˜èµ·ä¾†ï¼Œå†å°‡ dialog çš„é¡¯ç¤ºç‹€æ…‹æ”¹ç‚º trueï¼Œè®“ Dialog é–‹å•Ÿã€‚

å…¶å¯¦ä½ å¯ä»¥ç›´æ¥ä½¿ç”¨ $q.dialog é…åˆ h function ç°¡å–®å®Œæˆã€‚

```vue
<template>
  <div class="fit flex flex-col gap-4">
    <q-img
      class="w-[20rem] h-[15rem]"
      src="https://live.staticflickr.com/4325/35716212880_217fa28b46_k.jpg"
      @click="openImgWithDialog('https://live.staticflickr.com/4325/35716212880_217fa28b46_k.jpg')"
    />
  </div>
</template>

<script setup lang="ts">
import { QDialog, QImg, useQuasar } from 'quasar'
import { h } from 'vue'

const $q = useQuasar()

/** å°‡ QImg ä½¿ç”¨ QDialog åŒ…èµ·ä¾†å¾Œï¼Œä½¿ç”¨ $q.dialog é–‹å•Ÿ */
function openImgWithDialog(src: string) {
  $q.dialog({
    component: h(
      QDialog,
      undefined,
      { default: () => h(QImg, { src }) }
    )
  })
}
</script>
```

é€™æ¨£å°±å¯ä»¥ç°¡å–®å¿«é€Ÿçš„åˆ©ç”¨ Dialog é–‹å•Ÿåœ–ç‰‡äº†ï¼Œå®Œå…¨ä¸æœƒæœ‰é¡å¤–çš„ template èˆ‡è®Šæ•¸ï¼â™ª( â—œÏ‰â—Ùˆ(Ùˆ

::: tip
ä¸éå¦‚æœè¦è¤‡é›œçš„äº’å‹•ï¼Œä¾‹å¦‚ï¼šç¸®æ”¾å¹³ç§»ç­‰ç­‰ï¼Œç•¶ç„¶é‚„æ˜¯è¦åŒ…å€‹å°ˆç”¨å…ƒä»¶è™•ç†ã€‚
:::

ç•¶ç„¶ä¸åªæœ‰ QImgï¼Œæƒ³ç”¨å…¶ä»–å…ƒä»¶ä¹Ÿè¡Œï¼Œæ¦‚å¿µéƒ½ä¸€æ¨£ã€‚â—( â€¢Ï‰â€¢ )â—Ÿ

ä¸éé€™è£¡ç¨å¾®æœ‰å€‹å°å°çš„å›°æ“¾ï¼Œå°±æ˜¯ h function ä¸æœƒæç¤ºå…ƒä»¶çš„åƒæ•¸ï¼Œçµ¦éŒ¯æˆ–æ˜¯åƒæ•¸æ”¹äº†éƒ½ä¸çŸ¥é“ã€‚â€¦(â€ºÂ´Ï‰`â€¹ )

è®“æˆ‘å€‘å»ºç«‹ä¸€å€‹æœ‰å…ƒä»¶åƒæ•¸æç¤ºçš„ h function å§ï¼(/â‰§â–½â‰¦)/

## æœ‰å½¢åˆ¥æç¤ºçš„ h function

ç¬¬ä¸€æ­¥æ˜¯å»ºç«‹å”åŠ©æŠ½å– Vue å…ƒä»¶å‹åˆ¥çš„å¯¦ç”¨ functionã€‚

`types/index.ts`

```ts
import { Slot } from 'vue'

/** æå– Vue Component ä¹‹å…§éƒ¨ props
 *
 * æœƒå°‡ styleã€classã€event å…¨éƒ¨å–å‡ºä¾†
 */
export type ExtractComponentProps<Comp> = Comp extends new () => {
  $props: infer P;
}
  ? P
  : never

/** æå– Vue Component slots */
export type ExtractComponentSlots<Comp> = Comp extends new (...args: any) => {
  $slots?: infer S;
}
  ? (S extends Slot ? Parameters<S>[0]
      : {}
    ) : {}
```

æ¥è‘—æ–°å¢ typedH functionã€‚

`common/utils.ts`

```ts
import { Component, h } from 'vue'
import { ExtractComponentProps, ExtractComponentSlots } from '../types'

/** å…ƒä»¶ç¹¼æ‰¿åƒæ•¸
 *
 * [æ–‡ä»¶](https://cn.vuejs.org/guide/components/attrs.html#fallthrough-attributes)
 */
export interface InheritAttr {
  class?: string;
  style?: Record<string, string>;
  /** ç‚ºäº†è®“ç¯„ä¾‹ç²¾ç°¡ï¼Œé€™è£¡åªåˆ—å‡º clickï¼Œå¯ä»¥è‡ªè¡Œè¿½åŠ åŸºç¤äº‹ä»¶ */
  onClick?: (event: MouseEvent) => void;
}

/** Veu h function æœ‰å‹åˆ¥æ¨å°çš„ç‰ˆæœ¬
 *
 * [ä½•è¬‚ h function](https://cn.vuejs.org/guide/extras/render-function.html)
 *
 * @param component Vue SFC å…ƒä»¶æˆ– html tag åç¨±
 * @param props SFC å…§æ‰€æœ‰åƒæ•¸ï¼ŒåŒ…å« classã€styleã€event ç­‰ç­‰
 * @param slots SFC æ’æ§½
 */
export function typedH(
  component: string,
  props?: string,
): ReturnType<typeof h>
export function typedH<Comp extends Component>(
  component: string,
  props?: InheritAttr,
  slots?: ExtractComponentSlots<Comp>,
): ReturnType<typeof h>
export function typedH<Comp extends Component>(
  component: Comp,
  props?: ExtractComponentProps<Comp> & InheritAttr,
  slots?: ExtractComponentSlots<Comp>,
): ReturnType<typeof h>
export function typedH(
  component: any,
  props?: any,
  slots?: any,
) {
  if (!slots) {
    return h(component, props)
  }
  return h(component, props, slots)
}
```

ç”¨æ³•èˆ‡åŸæœ¬çš„ h function ä¸€æ¨¡ä¸€æ¨£ï¼Œç¾åœ¨æˆ‘å€‘æœ‰å‹åˆ¥æç¤ºäº†ï¼âœ§â‘ï½¡Ù©(ËŠá—œË‹*)Ùˆâœ§â•ï½¡*ï½¡

![å‹åˆ¥æç¤º](/vue-h-function-with-type-hints/Untitled.png)

å°±é€™æ¨£ï¼Œå…¶å¯¦ä¹Ÿä¸æ˜¯ç”šéº¼ç¥å¥‡çš„æ±è¥¿ã€‚(Â´,,â€¢Ï‰â€¢,,)

[ç¯„ä¾‹ç¨‹å¼](https://stackblitz.com/~/github.com/Codfisher/blog-vue-typed-h)åœ¨æ­¤ï¼Œå¤§å®¶ä¸‹æ¬¡è¦‹ã€‚( Â´ â–½ ` )ï¾‰

## ç¸½çµ ğŸŸ

- h function å¿«é€Ÿå°‡ç¾æœ‰å…ƒä»¶è®Šæˆ Dialog å…ƒä»¶
- é€é typedH function å¯ä»¥æœ‰å‹åˆ¥æç¤º
