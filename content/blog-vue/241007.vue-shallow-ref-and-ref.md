---
title: Vue 的 shallowRef 是啥？和 ref 有甚麼區別？
description: 
tags: ['vue']
image: https://codlin.me/vue-shallow-ref-and-ref.webp
date: 20241007

head:
  meta:
    - name: 'keywords'
      content: 'cod, lin'
---

# Vue 的 shallowRef 是啥？和 ref 有甚麼區別？

![vue-shallow-ref-and-ref](/vue-shallow-ref-and-ref.webp){height="600"}

使用 Vue 的朋友們一定知道 `ref` 是啥。ԅ( ˘ω˘ԅ)

不知道大家有沒有注意到 Vue 還有一個名字有點像，叫做 `shallowRef` 的 API。

所以 `shallowRef` 是啥？和 ref 有甚麼區別呢？

顧名思義，簡單來說 `shallowRef` 只對淺層（第一層）的值進行響應式處理。

也就是說考慮以下程式碼。

```vue
<script setup>
import { shallowRef } from 'vue'

const shallowData = shallowRef({ cod: [] })

async function updateShallowData() {
  shallowData.value.cod.push('fish')
}
</script>

<template>
  <div>
    shallowData: {{ shallowData.cod.length }}
  </div>
  <button @click="updateShallowData">
    更新資料
  </button>
</template>
```

[程式碼傳送門](https://play.vuejs.org/#eNp9kk1OwzAQha8y8qZFQukCVlVA/C5gAQjYYRbBmTQGx7ZiuxRFWXMDJMQlkOBMFcdg4tBSBGJnz7z3/I3thu1am0wDsjFLnail9eDQB7vNtaysqT004MpMKXN/jgW0UNSmggE5BlxzLYx25OgFB5nPYGtFPmxAmHwMV9fQrnXyzD1oAUXQwkujIdg883jx7R6uQcM1rAYm00wFTCgnscGVw0EhXTmgtJbrdNQjEyxtPFZWUR7tANJcTuPiR9gYmuU4MbyLVagnvoSWAsk3WhjTm+A9Qe4IJcXdFme/aDn7OmH+8j5/ev14e5w/PfchvZfa6WiJxdaZd3RhhZwkt85ouvI4LGfCVFYqrE9tdy2OM+LskzmLpx3Hmq8Dri/qokRx90f91s26GmdnNTqsp8jZsuezeoK+bx9enOCM1stmZfKgSP1P8xydUaFj7GV7QeeEvaKLtEfx40g9uXSHM4/aLYbqQDtlG/Wc0S/a/2f0b9yNZDP66NVZ+wk04O8u)

當我們點擊「更新資料」按鈕時，`shallowData.cod` 的長度不會被更新，文字永遠會保持 shallowData: 0。

除非 `updateShallowData` 的部份改成：

```ts
async function updateShallowData() {
  const cod = [...shallowData.value.cod, 'fish'];
  shallowData.value = { cod }
}
```

這樣就會因為第一層，也就是 `shallowData.value` 的值被改變，才會觸發響應，讓畫面更新。

看到這裡你可能會想「怎麼搞得更麻煩了？ლ（´口`ლ）」

別急別急，讓我們來看看為甚麼需要 `shallowRef` 這個玩意思。

## shallowRef 的使用場景

只對第一層的值進行響應式處理，最主要的目的就是「性能考量」。

## 總結 🐟
