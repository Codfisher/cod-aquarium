---
title: Vue å…ƒä»¶å¤ªè‚¥ï¼Œåˆ‡æ›é é¢å¡å¡æ€éº¼è¾¦ï¼Ÿè®“ Suspense ç™»å ´å§ï¼
description: åˆ‡æ›é é¢å¡å¡æœ‰å¾ˆå¤šç¨®åŸå› ï¼Œé€™è£¡èˆ‰çš„ä¾‹å­åªé‡å°å…ƒä»¶å¤ªå¤§çš„æƒ…å¢ƒã€‚é™¤äº†æƒ³è¾¦æ³•æ‹†åˆ†å¤–ï¼Œé‚„æœ‰ä¸€å€‹æ–¹æ³•å°±æ˜¯åˆ©ç”¨ Vue çš„ Async Componentã€‚
tags: ['Vue']
image: https://codlin.me/use-suspense-to-load-components-asynchronously.webp
date: 20240710
---

# Vue å…ƒä»¶å¤ªè‚¥ï¼Œåˆ‡æ›é é¢å¡å¡æ€éº¼è¾¦ï¼Ÿè®“ Suspense ç™»å ´å§ï¼

![use-suspense-to-load-components-asynchronously](/use-suspense-to-load-components-asynchronously.webp){height="600"}

é†œè©±èªªåœ¨å‰é ­ï¼Œåˆ‡æ›é é¢å¡å¡æœ‰å¾ˆå¤šç¨®åŸå› ï¼Œé€™è£¡èˆ‰çš„ä¾‹å­åªé‡å°å…ƒä»¶å¤ªå¤§çš„æƒ…å¢ƒå–”ã€‚( â€¢Ì€ Ï‰ â€¢Ì )âœ§

ç”šéº¼æ¨£çš„æƒ…æ³æœƒè®“å…ƒä»¶å¤ªå¤§å‘¢ï¼Ÿæœ‰å¯èƒ½æ˜¯ HTMLã€CSS å¤ªå¤šï¼Œä½†æœ€å¸¸è¦‹çš„æƒ…æ³å°±æ˜¯åŒ…äº†å¤ªå¤š JS åœ¨ä¸€èµ·äº†ã€‚â•®(â•¯â–½â•°)â•­ï¼ˆimport ä¸€å¤§å †å¥—ä»¶ç­‰ç­‰ï¼‰

é™¤äº†æƒ³è¾¦æ³•æ‹†åˆ†å¤–ï¼Œé‚„æœ‰ä¸€å€‹æ–¹æ³•å°±æ˜¯åˆ©ç”¨ Vue çš„ Async Componentã€‚

## Async Component æ˜¯ä»€éº¼ï¼Ÿ

ç”šéº¼æ˜¯ [Async Component](https://vuejs.org/guide/components/async)ï¼Ÿç°¡å–®ä¾†èªªå°±æ˜¯åœ¨çœŸçš„è¦ç”¨çš„æ™‚å€™æ‰å¾ server ä¸‹è¼‰å…ƒä»¶ï¼Œå¦‚æœç†Ÿæ‚‰ Vue Router çš„æœ‹å‹å€‘å°ä»¥ä¸‹å¯«æ³•ä¸€å®šä¸é™Œç”Ÿï¼š

```ts
const router = createRouter({
  // ...
  routes: [
    { 
      path: '/users/:id', 
      component: () => import('./views/UserDetails.vue') 
    },
  ],
})
```

é€™å€‹åœ¨ Vue Router ä¸­è¢«ç¨±ç‚º [Lazy Loading Routes](https://router.vuejs.org/guide/advanced/lazy-loading.html)ã€‚

æ­¤æ¦‚å¿µèˆ‡ Async Component æ¦‚å¿µç›¸åŒï¼Œç·¨è­¯ã€æ‰“åŒ…æ™‚æœƒå°‡æ¯å€‹é é¢æ‹†åˆ†ï¼Œåªæœ‰åœ¨çœŸçš„éœ€è¦æŸé é¢å…ƒä»¶æ™‚ï¼Œæ‰å¾ server ä¸‹è¼‰ï¼Œæ‰ä¸æœƒè®“é€²å…¥ç¶²é çš„ä½¿ç”¨è€…ç­‰å¾…ä¸‹è¼‰ä¸€å †é‚„ä¸æœƒç”¨åˆ°çš„é é¢ã€‚

è®“æˆ‘å€‘ä¾†ä¸€å€‹ç°¡å–®çš„ç¯„ä¾‹ï¼š

`App.vue`

```vue
<script setup>
import { defineAsyncComponent } from 'vue';
import FatComp from './components/FatComp.vue';

</script>

<template>
  Vue Suspense

  <hr />

  <FatComp />
</template>

```

å…¶ä¸­ FatComp æ˜¯ä¸€å€‹å’Œé±ˆé­šä¸€æ¨£è¶…è‚¥çš„å…ƒä»¶ï¼Œæœƒé¡¯ç¤ºã€Œå¾ˆå¤§å¾ˆå¤§çš„å…ƒä»¶ã€ã€‚

é±ˆé­šï¼šã€Œèªªå¥½çš„å°Šé‡å‘¢ï¼Ÿ(ï¾ŸĞ”ï¾Ÿ*)ï¾‰ã€

å¦‚æœæˆ‘å€‘ç›´æ¥ import å…ƒä»¶ï¼Œå°±å¿…é ˆç­‰å¾…å…ƒä»¶ä¸‹è¼‰å®Œæˆï¼Œ`App.vue` çš„ç•«é¢æ‰æœƒå‡ºç¾ã€‚

![åŒæ­¥è¼‰å…¥](/use-suspense-to-load-components-asynchronously/sync.gif){width="240px" format="gif"}

å¯ä»¥æ³¨æ„åˆ° Vue Suspense çš„æ–‡å­—æœƒç­‰åˆ° FatComp è¼‰å…¥å®Œæˆå¾Œæ‰æœƒé¡¯ç¤ºã€‚

å¦‚æœæˆ‘å€‘ä½¿ç”¨ Suspense æ”¹å¯«ï¼š

```vue
<script setup>
import { defineAsyncComponent } from 'vue';

const AsyncFatComp = defineAsyncComponent(() =>
  import('./components/FatComp.vue')
);
</script>

<template>
  Vue Suspense

  <hr />

  <Suspense>
    <AsyncFatComp />

    <template #fallback> Loading... </template>
  </Suspense>
</template>
```

![éåŒæ­¥è¼‰å…¥](/use-suspense-to-load-components-asynchronously/async.gif){width="240px" format="gif"}

å¯ä»¥çœ‹åˆ° Vue Suspense å­—æ¨£å…ˆå‡ºç¾ï¼Œè‚¥è‚¥çš„å…ƒä»¶å‰‡æœƒç­‰åˆ°ä¸‹è¼‰å®Œæˆæ‰å‡ºç¾ã€‚

æ­å–œé é¢ä¸å¡äº†ï¼âœ§â‘ï½¡Ù©(ËŠá—œË‹*)Ùˆâœ§â•ï½¡

Suspense å…ƒä»¶è©³ç´°èªªæ˜å¯ä»¥ä¾†[å®˜æ–¹æ–‡ä»¶](https://cn.vuejs.org/guide/built-ins/suspense)çœ‹çœ‹ã€‚

ä»¥ä¸Š[ç¯„ä¾‹ç¨‹å¼åœ¨æ­¤](https://stackblitz.com/edit/vue-suspense-cmte55?file=src%2FApp.vue&terminal=dev)ï¼Œæˆ‘å€‘ä¸‹æ¬¡å†è¦‹å›‰ï¼(Â´â–½`Êƒâ™¡Æª)

## ç¸½çµ ğŸŸ

- è‚¥å¤§å…ƒä»¶è«‹ç”¨ Async Component
- é…åˆ Suspense å¯ä»¥è®“é é¢æœ‰æ›´å¥½çš„ä½¿ç”¨è€…é«”é©—
