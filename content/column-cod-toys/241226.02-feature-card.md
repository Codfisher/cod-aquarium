---
title: CodToys - EP02ï¼šåŠŸèƒ½é¸é …
description: ä¸Šä¸€ç« ç¯€æˆ‘å€‘å®Œæˆäº†å¿«æ·éµé–‹é—œè¦–çª—åŠŸèƒ½ï¼Œé€™ä¸€ç« ç¯€æˆ‘å€‘ä¾†å¯¦ä½œåŠŸèƒ½é¸é …éƒ¨åˆ†å§ï¼
tags: ['Electron']
image: https://codlin.me/cod-toys.webp
date: 20241226
---

# CodToys - EP02ï¼šåŠŸèƒ½é¸é …

![å¿«æ¨‚å †ç©æœ¨çš„é­š](/cod-toys.webp){.cover}

ä¸Šä¸€ç« ç¯€æˆ‘å€‘å®Œæˆäº†å¿«æ·éµé–‹é—œè¦–çª—åŠŸèƒ½ï¼Œé€™ä¸€ç« ç¯€æˆ‘å€‘ä¾†å¯¦ä½œåŠŸèƒ½é¸é …éƒ¨åˆ†å§ï¼

## é–‹ç™¼

æœ¬ç« ç¯€é è¨ˆæœƒå»ºç«‹ä»¥ä¸‹å…§å®¹ï¼š

- è¼¸å…¥å€™é¸ï¼šåœ¨è¼¸å…¥æ¡†è¼¸å…¥å…§å®¹æ™‚ï¼Œæœƒé¡¯ç¤ºå€™é¸åŠŸèƒ½é¸é …
- åŠŸèƒ½é¸é …ï¼šæä¾›ä½¿ç”¨è€…é¸æ“‡åŠŸèƒ½ï¼Œä¸”å¯ä»¥é€éæ»‘é¼ æˆ–éµç›¤é¸æ“‡
- å»ºç«‹ã€Œæœå°‹é¡æ–‡å­—ã€Google æœå°‹ã€åŠŸèƒ½

### åŠŸèƒ½é¸é …å…ƒä»¶

ç¬¬ä¸€æ­¥è®“æˆ‘å€‘æ–°å¢åŠŸèƒ½é¸é …å…ƒä»¶

`src\components\feature-option.vue`

```vue
<template>
  <div
    ref="optionRef"
    class="flex items-center gap-2 duration-300"
    :class="{ 'bg-primary/30': selected }"
    @click="props.action()"
  >
    <q-icon
      v-if="props.icon"
      :name="props.icon"
      size="1.5rem"
    />
    <slot>
      {{ props.text }}
    </slot>
  </div>
</template>

<script setup lang="ts">
import { useElementHover } from '@vueuse/core'
import { computed, ref } from 'vue'

interface Props {
  icon?: string;
  text?: string;
  action?: () => void;
}
const props = withDefaults(defineProps<Props>(), {
  action: () => () => { },
})

defineSlots<{
  default?: () => unknown;
}>()

const optionRef = ref<HTMLDivElement>()
const isHover = useElementHover(optionRef)
const selected = computed(() => isHover.value)
</script>
```

æ­¤å…ƒä»¶è² è²¬å‘ˆç¾å¯ç”¨çš„åŠŸèƒ½é¸é …ï¼Œä¸¦ä¸”å¯ä»¥é€é `action` ä¾†è¨­å®šé»æ“Šå¾Œçš„è¡Œç‚ºã€‚

æ»‘é¼  `hover` æˆ–ä½¿ç”¨éµç›¤é¸æ“‡æ™‚ï¼Œæœƒè®Šæ›´èƒŒæ™¯è‰²ï¼Œé€™è£¡é ç•™ `selected`ï¼Œæ™šé»ä¾†å¯¦ä½œéµç›¤å°èˆªåŠŸèƒ½ã€‚

åœ¨ä½¿ç”¨ `feature-option` å…ƒä»¶å‰ï¼Œå…ˆè®“æˆ‘å€‘å°è£ä¸€ä¸‹ç›®å‰çš„è¼¸å…¥æ¡†å…ƒä»¶ã€‚

`src\components\main-input.vue`

```vue
<template>
  <q-input
    v-model="inputText"
    placeholder="è¦ä¾†é»ç”šéº¼ï¼Ÿ...(Â´,,â€¢Ï‰â€¢,,)"
    autofocus
    outlined
    square
  >
    <template #prepend>
      <q-icon name="search" />
    </template>
  </q-input>
</template>

<script setup lang="ts">
const inputText = defineModel({ default: '' })
</script>
```

<br>

æœ€å¾Œåœ¨é¦–é ä¸­å¼•å…¥ `feature-option` èˆ‡ `main-input` å…ƒä»¶ã€‚

`src\pages\index.vue`

```vue
<template>
  <div class="flex-col">
    <main-input v-model="inputText" />

    <div class="flex-col">
      <feature-option
        text="é¸é … 1"
        class="p-4"
      />
      <feature-option
        text="é¸é … 2"
        class="p-4"
      />
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref } from 'vue'
import FeatureOption from '../components/feature-option.vue'
import MainInput from '../components/main-input.vue'

const inputText = ref('')
</script>
```

çœ‹èµ·ä¾†æ˜¯ä¸æ˜¯ä¹¾æ·¨å¾ˆå¤šå‘¢ï¼Ÿ<span class="text-nowrap">ãƒ¾(â—'à±ª`â—)ï¾‰ï¾</span>

ç¾åœ¨è®“æˆ‘å€‘æ‰“é–‹è¦–çª—ã€‚

![feature-option](/cod-toys/feature-option.png)

...æœƒç™¼ç¾ã€Œé¸é … 2ã€è¢«åˆ‡æ‰å•¦ï¼<span class="text-nowrap">Î£(ËŠĞ”Ë‹;)</span>

é€™æ˜¯å› ç‚ºè¦–çª—é«˜åº¦æ²’æœ‰éš¨è‘—å…§å®¹å¢åŠ è€Œå¢åŠ ï¼Œè®“æˆ‘å€‘ä¾†ä¿®æ­£ä¸€ä¸‹å§ã€‚

### è‡ªå‹•èª¿æ•´è¦–çª—é«˜åº¦

ç”±æ–¼è¦–çª—ç”± main process æ§åˆ¶ï¼Œæˆ‘å€‘éœ€è¦è®“è¦–çª—èˆ‡ main process é€šè¨Šä¸¦èª¿æ•´è¦–çª—å¤§å°ã€‚

ä½¿ç”¨ `preload.ts` ä¾†å° renderer processï¼Œä¹Ÿå°±æ˜¯ç¶²é è¦–çª—æä¾›ç›´é€š main process çš„ API å§ã€‚

::: tip ç”šéº¼ processï¼Ÿ(*Â´ï½¥Ğ´ï½¥)
Electron åŸºæ–¼ multi-process æ¶æ§‹ï¼Œ[è©³ç´°è«‹åƒè€ƒå®˜æ–¹æ–‡ä»¶](https://www.electronjs.org/docs/latest/tutorial/process-model)ã€‚
:::

`electron\preload.ts`

```ts
import { contextBridge, ipcRenderer } from 'electron'

contextBridge.exposeInMainWorld('main', {
  updateHeight(height: number) {
    return ipcRenderer.send('updateHeight', height)
  },
  hideWindow() {
    return ipcRenderer.send('hideWindow')
  },
})
```

[`ipcRenderer`](https://www.electronjs.org/docs/latest/api/ipc-renderer) æ¨¡çµ„æä¾›äº† `send` æ–¹æ³•ï¼Œå¯ä»¥å°‡äº‹ä»¶ç™¼é€åˆ° main processã€‚

[`contextBridge`](https://www.electronjs.org/docs/latest/api/context-bridge) æ¨¡çµ„å‰‡è² è²¬å°‡ `main` ç‰©ä»¶æ³¨å…¥åœ¨ window ä¸­ï¼Œæˆ‘å€‘å¯ä»¥åœ¨ç¶²é ä¸­ä½¿ç”¨ `window.main` ä¾†å‘¼å« main process çš„æ–¹æ³•ã€‚

<br>

æ¥è‘—æˆ‘å€‘è¦åœ¨ main process ä¸­æ¥æ”¶é€™äº›äº‹ä»¶ï¼Œä½¿ç”¨ `ipcMain` æ¨¡çµ„ä¾†æ”¶è½äº‹ä»¶ï¼Œé †ä¾¿é‡æ§‹ä¸€ä¸‹ main ç¨‹å¼ç¢¼ã€‚

`electron\main.ts`

```ts
import path from 'node:path'
import process from 'node:process'
import {
  app,
  BrowserWindow,
  globalShortcut,
  ipcMain,
  screen,
} from 'electron'

async function createInputWindow() {
  const display = screen.getPrimaryDisplay()

  const newWindow = new BrowserWindow({
    width: display.bounds.width / 3,
    height: 100,
    show: false,
    backgroundColor: '#fff',
    frame: false,
    resizable: false,
    webPreferences: {
      preload: path.join(__dirname, './preload.js'),
    },
  })
  // éš±è—é è¨­ç³»çµ±é¸å–®
  newWindow.setMenu(null)

  // å¤±å»ç„¦é»æ™‚è‡ªå‹•éš±è—è¦–çª—
  newWindow.on('blur', () => {
    newWindow.hide()
  })

  if (process.env.VITE_DEV_SERVER_URL) {
    await newWindow.loadURL(process.env.VITE_DEV_SERVER_URL)
  }
  else {
    await newWindow.loadFile('dist/index.html')
  }

  return newWindow
}

function initGlobalShortcut(mainWindow: BrowserWindow) {
  const ret = globalShortcut.register('Ctrl+Space', () => {
    if (mainWindow?.isVisible()) {
      // focusable è¨­ç‚º falseï¼Œæ‰å¯ä»¥è®“ç„¦é»å›åˆ°åŸæœ¬ä½ç½®ã€‚ä¾‹å¦‚æ­£åœ¨è¼¸å…¥çš„ç·¨è¼¯å™¨
      mainWindow.setFocusable(false)
      mainWindow.hide()

      return
    }

    const cursorPoint = screen.getCursorScreenPoint()
    const display = screen.getDisplayNearestPoint(cursorPoint)

    // è¨­å®šæ»‘é¼ ä½ç½®ä¹‹è¦–çª—ä¸­é–“å¾€ä¸Š 1/3 çš„ä½ç½®
    const [width, height] = mainWindow.getSize()
    if (!width || !height)
      return

    mainWindow?.setPosition(
      Math.floor(display.bounds.x + display.bounds.width / 2 - width / 2),
      Math.floor(display.bounds.y + display.bounds.height / 3 - height / 2),
    )

    mainWindow.setFocusable(true)
    mainWindow.show()
  })

  if (!ret) {
    console.error('registration failed')
  }
}

function initIpcMain(mainWindow: BrowserWindow) {
  ipcMain.on('updateHeight', (event, height: number) => {
    mainWindow.setBounds({ height })
  })

  ipcMain.on('hideWindow', (event) => {
    mainWindow.setFocusable(false)
    mainWindow.hide()
  })
}

app.whenReady().then(async () => {
  const mainWindow = await createInputWindow()

  initGlobalShortcut(mainWindow)
  initIpcMain(mainWindow)
})

app.on('window-all-closed', () => {
  if (process.platform !== 'darwin') {
    app.quit()
  }

  globalShortcut.unregisterAll()
})
```

<br>

ç¾åœ¨æˆ‘å€‘éœ€è¦åœ¨ç¶²é ä¸­ä½¿ç”¨ `mainApi`ï¼Œæ—¢ç„¶æ˜¯ TypeScript å°ˆæ¡ˆï¼Œç¬¬ä¸€æ­¥ç•¶ç„¶æ˜¯å®šç¾©å‹åˆ¥å•¦ã€‚

`electron\electron-env.d.ts`

```ts
export interface MainApi {
  updateHeight: (height: number) => void;
  hideWindow: () => void;
}

declare global {
  interface Window {
    main: MainApi;
  }
}

export { }
```

<br>

æ¥è‘—æŠŠ `contextBridge` æ¨¡çµ„æ³¨å…¥çš„ `main` ç‰©ä»¶é€é Composition API å½¢å¼æä¾›ï¼Œä¿ç•™æœªä¾†æ›´å‹•å½ˆæ€§ã€‚

`src\composables\use-main-api.ts`

```ts
/** æä¾› Electron main process API */
export function useMainApi() {
  return window.main
}
```

<br>

ç¾åœ¨è®“è¦–çª—æ ¹æ“šå…§å®¹é«˜åº¦è‡ªå‹•èª¿æ•´ï¼Œä½¿ç”¨ `useElementBounding` è¼•é¬†å®Œæˆï¼<span class="text-nowrap">ãƒ½(â—`âˆ€Â´â—)ï¾‰</span>

```vue
<template>
  <div
    ref="pageRef"
    class="flex-col"
  >
    // ...
  </div>
</template>

<script setup lang="ts">
const mainApi = useMainApi()

const inputText = ref('')

// åŒæ­¥è¦–çª—èˆ‡é é¢é«˜åº¦
const pageRef = ref<HTMLDivElement>()
const { height } = useElementBounding(pageRef)

watchEffect(() => {
  mainApi.updateHeight(height.value)
})
</script>
```

ç¾åœ¨é–‹å•Ÿè¦–çª—ï¼Œå¯ä»¥çœ‹åˆ°é€™æ¬¡é¸é … 2 é †åˆ©å‡ºç¾äº†ã€‚

![window-auto-resize](/cod-toys/window-auto-resize.png)

<br>

æœ€å¾Œæˆ‘å€‘æŠŠåŸæœ¬åœ¨ `main.ts` ä¸­çš„ã€Œè¦–çª— blur æ™‚è‡ªå‹•éš±è—è¦–çª—ã€çš„é‚è¼¯ç§»åˆ°é¦–é ä¸­ï¼Œæ–¹ä¾¿æœªä¾†ä¾é é¢éœ€æ±‚è‡ªå®šç¾©ã€‚

`electron\main.ts`

```ts
// ...
async function createInputWindow() {
  // ...

  // å¤±å»ç„¦é»æ™‚è‡ªå‹•éš±è—è¦–çª— // [!code --]
  newWindow.on('blur', () => { // [!code --]
    newWindow.hide() // [!code --]
  }) // [!code --]

  // ...
}
// ...
```

<br>

æ‰€ä»¥ç¶²é ä¸­è¦æ€éº¼åˆ¤æ–·è¦–çª—æ˜¯å¦ blurï¼Ÿ<span class="text-nowrap">(Â´ï½¥Ï‰ï½¥`)</span>

å…¶å¯¦å¾ˆç°¡å–®ï¼Œé€é `useWindowFocus` è¼•é¬†å¯¦ç¾ï¼

`src\pages\index.vue`

```vue
<template>
  // ...
</template>

<script setup lang="ts">
// ...

// è¦–çª— blur æ™‚ï¼Œæ¸…ç©º inputText ä¸¦éš±è—è¦–çª—
const focused = useWindowFocus()
whenever(
  () => !focused.value,
  () => {
    inputText.value = ''
    mainApi.hideWindow()
  },
)
</script>
```

æ„Ÿæ© VueUseï¼è®šå˜† VueUseï¼(*Â´âˆ€`)~â™¥

### éµç›¤å°èˆª

é¸é …æœ‰äº†ï¼Œé‚£å°±ä¾†å¯¦ä½œéµç›¤å°èˆªåŠŸèƒ½å§ã€‚

é€™è£¡è®“ `feature-option` å…ƒä»¶è¨»å†Šè‡ªå·±çš„ IDï¼Œé€é ID é¸æ“‡å¯ç”¨çš„ optionã€‚

å»ºç«‹ä¸€å€‹ `feature.store.ts` ä¾†ç®¡ç†ä¸¦è¨»å†Š optionã€‚

`src\stores\feature.store.ts`

```ts
import { defineStore } from 'pinia'
import { pipe, sortBy } from 'remeda'
import { computed, ref, shallowRef, triggerRef } from 'vue'

interface OptionValue {
  action: () => void;
}

export const useFeatureStore = defineStore('feature', () => {
  const optionMap = shallowRef(new Map<string, OptionValue>())
  const optionIdList = computed(() => pipe(
    [...optionMap.value.keys()],
    /** ä¾ç…§æ•¸å­—æ’åºï¼Œä¿è­‰ option é †åº */
    sortBy((id) => Number.parseInt(id.replace(/\D/g, ''), 10)),
  ))

  function addOption(id: string, value: OptionValue) {
    optionMap.value.set(id, value)
    triggerRef(optionMap)
  }
  function removeOption(id: string) {
    optionMap.value.delete(id)
    triggerRef(optionMap)
  }

  const selectedOptionId = ref('')
  function setOption(id: string) {
    selectedOptionId.value = id
  }
  function nextOption() {
    const first = optionIdList.value.at(0)

    const index = optionIdList.value.indexOf(selectedOptionId.value)
    if (index < 0 && first) {
      selectedOptionId.value = first
      return
    }

    const target = optionIdList.value[index + 1]
    if (target || first) {
      selectedOptionId.value = (target ?? first)!
    }
  }
  function prevOption() {
    const last = optionIdList.value.at(-1)

    const index = optionIdList.value.indexOf(selectedOptionId.value)
    if (index < 0 && last) {
      selectedOptionId.value = last
      return
    }

    const target = optionIdList.value[index - 1]
    if (target || last) {
      selectedOptionId.value = (target ?? last)!
    }
  }

  const currentOption = computed(() => optionMap.value.get(selectedOptionId.value))

  return {
    optionIdList,
    addOption,
    removeOption,

    selectedOptionId,
    setOption,
    nextOption,
    prevOption,

    currentOption,
  }
})
```

`feature.store` ä¸»è¦æä¾›ä»¥ä¸‹é‚è¼¯ï¼š

- è¨»å†Šã€ç§»é™¤ option
- è¨­å®šæˆ–å‰å¾Œé¸æ“‡ option

<br>

æ¥è‘—åœ¨ `feature-option` æ–°å¢é‚è¼¯ï¼š

- è¨»å†Šè‡ªå·±çš„ ID èˆ‡ `action`
- `onUnmounted` æ™‚ç§»é™¤ IDã€‚
- `selected` ä¾ç…§ `feature.store` è³‡æ–™åˆ¤æ–·

`src\components\feature-option.vue`

```vue
<template>
  // ...
</template>

<script setup lang="ts">
// ...

const featureStore = useFeatureStore()

const id = useId()

featureStore.addOption(id, {
  action: props.action,
})
onUnmounted(() => {
  featureStore.removeOption(id)
})

// ...
const selected = computed(
  () => isHover.value || featureStore.selectedOptionId === id,
)
</script>
```

æœ€å¾Œè®“æˆ‘å€‘åœ¨ `main-input` ä¸­è¨»å†Šéµç›¤äº‹ä»¶ï¼Œå¯¦ç¾éµç›¤é¸æ“‡é¸é …åŠŸèƒ½ã€‚

`src\components\main-input.vue`

```vue
<template>
  <q-input
    ...
    @keydown="handleKeydown"
  >
    // ...
  </q-input>
</template>

<script setup lang="ts">
// ...
const keydownEventMap: Record<
  /** key name
   *
   * https://developer.mozilla.org/zh-CN/docs/Web/API/UI_Events/Keyboard_event_key_values
   */
  string,
  (event: KeyboardEvent) => Promise<void>
> = {
  async Escape() {
    // å·²æ¸…ç©ºå‰‡éš±è—è¦–çª—
    if (inputText.value === '') {
      mainApi.hideWindow()
    }

    inputText.value = ''
  },
  async ArrowDown(event) {
    event.preventDefault()
    featureStore.nextOption()
  },
  async ArrowUp(event) {
    event.preventDefault()
    featureStore.prevOption()
  },
  async Enter() {
    featureStore.currentOption?.action()
  },
}
function handleKeydown(event: KeyboardEvent) {
  keydownEventMap[event.key]?.(event)
}
</script>
```

ç¾åœ¨æˆ‘å€‘å¯ä»¥é€ééµç›¤è§¸ç™¼ä»¥ä¸‹åŠŸèƒ½ï¼š

- Escape æ¸…ç©ºè¼¸å…¥æ¡†ï¼Œè‹¥å…§å®¹ç‚ºç©ºå‰‡éš±è—è¦–çª—
- ä¸Šä¸‹éµé¸æ“‡é¸é …
- Enter åŸ·è¡Œé¸é …ã€‚

![keyboard-selection-option](/cod-toys/keyboard-selection-option.gif)

è¶Šä¾†è¶Šæœ‰æ¨¡æœ‰æ¨£äº†ï¼<span class="text-nowrap">âœ§â‘ï½¡Ù©(ËŠá—œË‹*)Ùˆâœ§â•ï½¡</span>

### æ–°å¢åŠŸèƒ½å¡ç‰‡

æ¥è‘—è®“æˆ‘å€‘æ–°å¢åŠŸèƒ½å¡ç‰‡ï¼ŒåŠŸèƒ½å¡ç‰‡æœƒè‡ªå‹•æ ¹æ“šä½¿ç”¨è€…è¼¸å…¥å…§å®¹æä¾›å¯ç”¨é¸é …ã€‚

å¯é æœŸæ¯å€‹å¡ç‰‡éƒ½æœƒæœ‰è‡ªå·±çš„å°ˆå±¬é‚è¼¯ï¼Œæ‰€ä»¥æˆ‘å€‘å°‡å¡ç‰‡å…ƒä»¶ç¨ç«‹åœ¨ `domains` è³‡æ–™å¤¾ä¸­ã€‚

#### æœå°‹é¡æ–‡å­—

`src\domains\feature-card-kaomoji\index.vue`

```vue
<template>
  <template v-if="visible">
    <feature-option
      v-if="!isFeature"
      class="p-4"
      icon="emoticon"
      text="è¼¸å…¥ @ æœå°‹é¡æ–‡å­—"
      :action="() => setText('@')"
    />

    <template v-else>
      <feature-option
        v-for="text, i in textList"
        :key="i"
        class="p-4"
        :text
        :action="() => copy(text)"
      />
    </template>
  </template>
</template>

<script setup lang="ts">
import { computed } from 'vue'
import FeatureOption from '../../components/feature-option.vue'
import { useMainApi } from '../../composables/use-main-api'

const mainApi = useMainApi()

const inputText = defineModel({ default: '' })

const visible = computed(() => {
  return !inputText.value || inputText.value.startsWith('@')
})

const isFeature = computed(() => inputText.value.startsWith('@'))

function setText(text: string) {
  inputText.value = text
}

function copy(text: string) {
  navigator.clipboard.writeText(text)
  mainApi.hideWindow()
}

const textList = [
  '(Â´â–½`Êƒâ™¡Æª)',
  'à©­ Ë™á—œË™ )à©­',
  '(*Â´âˆ€`)~â™¥',
]
</script>
```

å› ç‚ºé‚„æ²’é€£æ¥è³‡æ–™åº«ï¼Œæ‰€ä»¥å…ˆæš«æ™‚å¯«æ­» 3 å€‹é¡æ–‡å­—æ¸¬è©¦åŠŸèƒ½ã€‚

æ¥è‘—åœ¨é¦–é ä¸­å¼•å…¥åŠŸèƒ½å¡ç‰‡ã€‚

`src\pages\index.vue`

```vue
<template>
  <div>
    // ...

    <div class="flex-col">
      <feature-card-kaomoji v-model="inputText" />
    </div>
  </div>
</template>

<script setup lang="ts">
import FeatureCardKaomoji from '../domains/feature-card-kaomoji/index.vue'
</script>
```

ç¾åœ¨è¼¸å…¥ `@` å³å¯æœå°‹é¡æ–‡å­—ï¼Œè€Œä¸”é¸æ“‡å¾Œå¯ä»¥ç›´æ¥è¤‡è£½åˆ°å‰ªè²¼ç°¿ã€‚

![select-and-copy-kaomoji](/cod-toys/select-and-copy-kaomoji.gif)

#### Google æœå°‹

åªæœ‰ä¸€å€‹åŠŸèƒ½æœ‰é»å­¤å–®ï¼Œè®“æˆ‘å€‘å†æ–°å¢ä¸€å€‹å¯ä»¥å¿«é€Ÿé–‹å§‹ Google æœå°‹çš„åŠŸèƒ½å¡ç‰‡å§ï¼<span class="text-nowrap">(/â‰§â–½â‰¦)/</span>

é€™è£¡éœ€è¦åœ¨ `mainApi` æ–°å¢ä¸€å€‹ APIï¼Œç”¨ä¾†é–‹å•Ÿç€è¦½å™¨ã€‚

`electron\electron-env.d.ts`

```ts
export interface MainApi {
  // ...
  openExternal: (url: string) => void;
}

// ...
```

`electron\preload.ts`

```ts
import { contextBridge, ipcRenderer } from 'electron'

contextBridge.exposeInMainWorld('main', {
  // ...
  openExternal(url: string) {
    return ipcRenderer.send('openExternal', url)
  },
})
```

`electron\main.ts`

```ts
// ...

function initIpcMain(mainWindow: BrowserWindow) {
  // ...

  ipcMain.on('openExternal', (event, url: string) => {
    shell.openExternal(url)
  })
}

// ...
```

é€™è£¡ä½¿ç”¨äº† [`shell`](https://www.electronjs.org/docs/latest/api/shell) æ¨¡çµ„ï¼Œå¯ä»¥è®“æˆ‘å€‘é–‹å•Ÿå¤–éƒ¨ç€è¦½å™¨ã€‚

<br>

æ¥è‘—è®“æˆ‘å€‘æ–°å¢ `feature-card-google` åŠŸèƒ½å¡ç‰‡å…ƒä»¶ã€‚

`src\domains\feature-card-google\index.vue`

```vue
<template>
  <feature-option
    v-if="visible"
    class="p-4"
    icon="search"
    text="åœ¨ Google ä¸Šæœå°‹"
    :action
  />
</template>

<script setup lang="ts">
import { computed } from 'vue'
import FeatureOption from '../../components/feature-option.vue'
import { useMainApi } from '../../composables/use-main-api'

const mainApi = useMainApi()

const inputText = defineModel({ default: '' })

const visible = computed(() => {
  if (!inputText.value) {
    return false
  }

  return !inputText.value.startsWith('@')
})

function action() {
  const url = [
    `https://www.google.com/search?q=`,
    encodeURIComponent(inputText.value),
  ].join('')
  mainApi.openExternal(url)
  mainApi.hideWindow()
}
</script>
```

<br>

æ¥è‘—åœ¨é¦–é å¼•å…¥åŠŸèƒ½å¡ç‰‡ã€‚

ä¸éæ¯æ¬¡æ–°å¢åŠŸèƒ½å¡ç‰‡éƒ½è¦æ‰‹å‹•å¼•å…¥å¥½éº»ç…©ï¼Œè®“æˆ‘å€‘è‡ªå‹•å¼•å…¥å§ï¼<span class="text-nowrap">( Â´ â–½ ` )ï¾‰</span>

`src\pages\index.vue`

```vue
<template>
  <div>
    // ...

    <div class="flex-col">
      <component
        :is="card"
        v-for="card, key in featureCards"
        :key
        v-model="inputText"
      />
    </div>
  </div>
</template>

<script setup lang="ts">
const featureCards = import.meta.glob('../domains/feature-card-*/index.vue', {
  import: 'default',
  eager: true,
})

// ...
</script>
```

::: tip
é€™è£¡ä½¿ç”¨äº† Vite çš„ [glob åŠŸèƒ½](https://vite.dev/guide/features#glob-import)
:::

<br>

ç¾åœ¨å¯ä»¥è¼¸å…¥ä»»ä½•å…§å®¹ä¸¦é–‹å•Ÿç€è¦½å™¨è·³è½‰ Google æœå°‹äº†ï¼<span class="text-nowrap">â—(â‰§âˆ€â‰¦)â—Ÿ</span>

![google-search](/cod-toys/google-search.gif)

æ ¸å¿ƒåŠŸèƒ½åŸºæœ¬ä¸Šéƒ½å®Œæˆäº†ï¼Œæ„Ÿè¦ºè¶…è®šï¼<span class="text-nowrap">(â‰§âˆ‡â‰¦)ï¾‰</span>

## ç¸½çµ ğŸŸ

ä»¥ä¸Šç¨‹å¼ç¢¼å¯ä»¥[åœ¨æ­¤å–å¾—](https://github.com/Codfisher/side-project-cod-toys/tree/feat/feature-card)

- å®Œæˆä¾ç…§é—œéµå­—å€™é¸åŠŸèƒ½é¸é …
- `ipcRenderer` å¯ä»¥è®“ç¶²é èˆ‡ main process é€šè¨Š
- å®Œæˆæœå°‹é¡æ–‡å­—èˆ‡ Google æœå°‹åŠŸèƒ½

ä¸‹ä¸€ç« è®“æˆ‘å€‘ä¾†å¯¦ä½œé€£æ¥ Notion Database èˆ‡æ¨¡ç³Šæœå°‹å§ã€‚<span class="text-nowrap">(â‰–â€¿ã‚â‰–)âœ§</span>

::: tip
å› ç‚ºç¯‡å¹…å•é¡Œï¼ŒæŸäº›éƒ¨åˆ†ç°¡å–®å¸¶éã€‚

è‹¥æƒ³çœ‹åˆ°æ›´è©³ç´°çš„è§£é‡‹ï¼Œè«‹ä¸åç•™è¨€æˆ–å¯«ä¿¡çµ¦æˆ‘å–”ï¼<span class="text-nowrap">(*Â´âˆ€`)~â™¥</span>
:::
