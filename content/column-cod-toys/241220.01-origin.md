---
title: CodToys - EP01ï¼šç·£èµ·
description: æ²’æœ‰é †æ‰‹çš„å°å·¥å…·æ€éº¼è¾¦ï¼Ÿç”¨ Electron å‹•æ‰‹åšä¸€å€‹å§ï¼(Â´,,â€¢Ï‰â€¢,,)
tags: ['CodToys', 'Electron']
image: https://codlin.me/cod-toys.webp
date: 20241221
---

# CodToys - EP01ï¼šç·£èµ·

![å¿«æ¨‚å †ç©æœ¨çš„é­š](/cod-toys.webp)

è‡ªå·±å¯«æ–‡ç« æ™‚ç¿’æ…£åœ¨æ–‡å­—ä¸­ç©¿æ’é¡æ–‡å­—ã€‚<span class="text-nowrap">( â€¢Ì€ Ï‰ â€¢Ì )âœ§</span>

æœ€è¿‘è¼ƒå¸¸å¯«æ–‡ç« åˆ†äº«ï¼Œè¼¸å…¥é¡æ–‡å­—çš„æ¬¡æ•¸ä¹Ÿè¶Šä¾†è¶Šå¤šäº†ã€‚

é›–ç„¶ Windows å¯ä»¥æŒ‰ä¸‹ã€ŒWindow + .ã€ä¹Ÿå¯ä»¥å¿«é€Ÿé¸æ“‡é¡æ–‡å­—

ä½†æ˜¯èº«ç‚ºè³‡æ·±é¡æ–‡å­—æ„›å¥½è€…ï¼Œä¸€å®šæœ‰è‡ªå·±çš„é¡æ–‡å­—åº«å•Šï¼

æ–¼æ˜¯èŒç”Ÿäº†è‡ªå·±åšä¸€å€‹éµç›¤å¿«æ·éµå°å·¥å…·çš„å¿µé ­ï¼Œæ­¤å°ˆæ¡ˆå°±é€™éº¼èª•ç”Ÿäº†ã€‚<span class="text-nowrap">Ô…(Â´âˆ€` Ô…)</span>

è®“æˆ‘å€‘æ¶å…ˆçœ‹ä¸€ä¸‹æˆæœï¼<span class="text-nowrap">Ë‹( Â° â–½ã€Â° )</span>

![shortcut-key-selection-options](/cod-toys/shortcut-key-selection-options.gif)

<br>

è·¯äººï¼šã€Œè½èªªç¾åœ¨å¹´è¼•ä¸€è¼©æ²’äººåœ¨ç”¨é¡æ–‡å­—çš„æã€‚('â—‰â—âŠ–â—Ÿâ—‰` )ã€

é±ˆé­šï¼šã€Œæˆ‘å°±è€ï¼Œæˆ‘å°±æ˜¯è¦ç”¨ã€‚á••( ï¾Ÿ âˆ€ã€‚)á•— ã€

## èƒŒæ™¯

é–‹å§‹å‰ä¾†ç°¡å–®äº†è§£ä¸€ä¸‹ç›¸é—œèƒŒæ™¯ã€‚

- PowerToys

  [PowerToys](https://learn.microsoft.com/zh-tw/windows/powertoys/) æ˜¯å¾®è»Ÿé‡‹å‡ºçš„é–‹æºå°ˆæ¡ˆï¼Œæä¾›äº†ä¸€ç³»åˆ—å¯¦ç”¨åŠŸèƒ½ã€‚ä¾‹å¦‚ï¼š[é¡è‰²é¸æ“‡å™¨](https://learn.microsoft.com/zh-tw/windows/powertoys/color-picker)ã€[æ‰¾ä¸åˆ°å‘½ä»¤](https://learn.microsoft.com/zh-tw/windows/powertoys/cmd-not-found)ç­‰ç­‰ã€‚

  å…¶ä¸­ [PowerToys Run](https://learn.microsoft.com/zh-tw/windows/powertoys/run) å·¥å…·æ˜¯æˆ‘å€‘çš„ä¸»è¦éˆæ„Ÿä¾†æºï¼Œæœ¬å°ˆæ¡ˆ~~æŠ„è¥²~~å€Ÿé‘‘å…¶è¨­è¨ˆã€‚

- Electron

  [Electron](https://www.electronjs.org/) æ˜¯ä¸€å€‹å¯ä»¥ç”¨ HTMLã€CSSã€JavaScript å»ºç«‹è·¨å¹³å°æ¡Œé¢æ‡‰ç”¨ç¨‹å¼çš„æ¡†æ¶ã€‚

  æ­¤æ¡†æ¶ç”± GitHub é–‹ç™¼ï¼Œæœ‰è¨±å¤šçŸ¥åæ‡‰ç”¨ç¨‹å¼ä¹Ÿç”¨ Electron é–‹ç™¼ï¼Œä¾‹å¦‚ï¼š[VS Code](https://code.visualstudio.com/)ã€[Slack](https://slack.com/)ã€[Discord](https://discord.com/) ç­‰ç­‰ã€‚

## ç‰¹é»

ç›®å‰ä¸»è¦åŠŸèƒ½è¦åŠƒèˆ‡ç‰¹é»å¦‚ä¸‹ï¼š

- éµç›¤å„ªå…ˆ

  å‘¼å«å·¥å…·ã€é¸æ“‡åŠŸèƒ½çš†ä½¿ç”¨éµç›¤æ“ä½œï¼Œç›¡å¯èƒ½åœ¨ä¸ä¸­æ–·è¼¸å…¥çš„æƒ…æ³ä¸‹å¿«é€Ÿä½¿ç”¨

- é—œéµå­—æœå°‹

  æ ¹æ“šè¼¸å…¥çš„é—œéµå­—éæ¿¾ï¼Œæä¾›å€™é¸åŠŸèƒ½

- åŠŸèƒ½ï¼šé¡æ–‡å­—è³‡æ–™åº«

  å¾ Notion Database å–å¾—é¡æ–‡å­—è³‡æ–™ï¼Œé¸æ“‡å¾Œè¤‡è£½è‡³å‰ªè²¼ç°¿

ä»‹é¢å‰‡æ¨¡ä»¿ [PowerToys Run](https://learn.microsoft.com/zh-tw/windows/powertoys/run) çš„å•Ÿå‹•å™¨ï¼ŒæŒ‰ä¸‹ `Ctrl + Space` å°±æœƒè·³å‡ºé¡ä¼¼ä¸‹åœ–è¼¸å…¥æ¡†ã€‚

![power-toys-run](/cod-toys/power-toys-run.png)

è®“æˆ‘å€‘é–‹å§‹å§ï¼<span class="text-nowrap">( â€¢Ì€ Ï‰ â€¢Ì )âœ§</span>

## é–‹ç™¼

å°ˆæ¡ˆåŸºæ–¼ä»¥ä¸‹æŠ€è¡“æˆ–å¥—ä»¶é–‹ç™¼ï¼š

- Vue 3ã€Pinia
- [VueUse](https://vueuse.org/functions.html)
- [unplugin-vue-router](https://github.com/posva/unplugin-vue-router)
- [UnoCSS](https://unocss.dev/)
- [Quasar](https://quasar.dev/)
- [Electron](https://www.electronjs.org/)

### åœ¨ç¾æœ‰ Vue å°ˆæ¡ˆä¸­åŠ å…¥ Electron

é›–ç„¶å®˜æ–¹æ¨è–¦ä½¿ç”¨ [Electron Forge](https://www.electronforge.io/) å»ºç«‹å°ˆæ¡ˆï¼Œä¸éæˆ‘å·²ç¶“æœ‰ä¸€å€‹è¨­å®šå®Œæˆçš„ Vue æ¨¡æ¿ï¼Œæ‰€ä»¥é€™æ¬¡ä½¿ç”¨ `vite-plugin-electron` ä¾†æ•´åˆ Electronã€‚

æ­¥é©Ÿæ²’ä»€éº¼ç‰¹åˆ¥çš„éƒ¨åˆ†ï¼ŒåŸºæœ¬ä¸Šå®Œå…¨ä¾ç…§[æ–‡ä»¶](https://github.com/electron-vite/vite-plugin-electron)æ“ä½œã€‚

ä¸€é™£çŒ›å¦‚è™çš„æ“ä½œå¾Œï¼Œæˆ‘å€‘å¾—åˆ°äº†[åˆå§‹ç’°å¢ƒ](https://github.com/Codfisher/side-project-cod-toys/tree/init)ï¼<span class="text-nowrap">Ë‹( Â° â–½ã€Â° )</span>

### é–‹å•Ÿè¦–çª—

ç¬¬ä¸€æ­¥ç•¶ç„¶æ˜¯å…ˆåšä¸€å€‹ç°¡å–®çš„è¼¸å…¥æ¡†ã€‚

`src\pages\index.vue`

```vue
<template>
  <div class="flex-col">
    <q-input
      v-model="inputValue"
      placeholder="è¦ä¾†é»ç”šéº¼ï¼Ÿ...(Â´,,â€¢Ï‰â€¢,,)"
      autofocus
      outlined
      square
    >
      <template #prepend>
        <q-icon name="search" />
      </template>
    </q-input>
  </div>
</template>

<script setup lang="ts">
import { ref } from 'vue'

const inputValue = ref('')
</script>
```

æ¥è‘—è®“æˆ‘å€‘å•Ÿå‹• Electron é­”æ³•ï¼ŒæŠŠç¶²é è®Šæˆæ‡‰ç”¨ç¨‹å¼è¦–çª—ï¼<span class="text-nowrap">â—( â€¢Ï‰â€¢ )â—Ÿ</span>

`electron\main.ts`

```ts
import process from 'node:process'
import {
  app,
  BrowserWindow,
} from 'electron'

async function createInputWindow() {
  const newWindow = new BrowserWindow({
    width: 400,
    height: 100,
    backgroundColor: '#fff',
    frame: false,
    resizable: false,
  })
  // éš±è—é è¨­ç³»çµ±é¸å–®
  newWindow.setMenu(null)

  if (process.env.VITE_DEV_SERVER_URL) {
    await newWindow.loadURL(process.env.VITE_DEV_SERVER_URL)
  }
  else {
    await newWindow.loadFile('dist/index.html')
  }

  return newWindow
}

let mainWindow: BrowserWindow | undefined

app.whenReady().then(async () => {
  mainWindow = await createInputWindow()
})

// ç•¶æ‰€æœ‰è¦–çª—é—œé–‰æ™‚é€€å‡ºæ‡‰ç”¨ç¨‹å¼
app.on('window-all-closed', () => {
  if (process.platform !== 'darwin') {
    app.quit()
  }
})
```

`BrowserWindow` è¡¨ç¤ºä¸€å€‹è¦–çª—ï¼Œå°±åƒæ˜¯é–‹å•Ÿä¸€å€‹ç¶²é ä¸€èˆ¬ã€‚

`app.whenReady` å‰‡è¡¨ç¤ºåœ¨æ‡‰ç”¨ç¨‹å¼æº–å‚™å¥½æ™‚åŸ·è¡Œã€‚

ç¾åœ¨è®“æˆ‘å€‘åŸ·è¡Œ `npm run dev` çœ‹çœ‹æ•ˆæœå§ï¼

![first-window](/cod-toys/first-window.png)

è¼¸å…¥æ¡†å‡ºç¾æƒ¹ï¼<span class="text-nowrap">(/â‰§â–½â‰¦)/</span>

### ç¶å®šå…¨åŸŸå¿«æ·éµ

æ¥è‘—æ˜¯æœ€é‡è¦çš„ä¸€æ­¥ï¼Œè¦ç¶å®šå…¨åŸŸå¿«æ·éµï¼Œç•¶æŒ‰ä¸‹ `Ctrl + Space` æ™‚é¡¯ç¤ºè¦–çª—ã€‚

é€™è£¡éœ€è¦ä½¿ç”¨ [`globalShortcut` æ¨¡çµ„](https://www.electronjs.org/docs/latest/api/global-shortcut)ã€‚

æ­¤æ¨¡çµ„å¯ä»¥è¨»å†Šå…¨åŸŸå¿«æ·éµï¼Œå³ä½¿è¦–çª—æ²’æœ‰èšç„¦ï¼Œä¾ç„¶å¯ä»¥åŸ·è¡Œå·²è¨»å†Šçš„æŒ‰éµäº‹ä»¶ã€‚

ä¸€é–‹å§‹å…ˆä¿æŒç°¡å–®ï¼ŒæŒ‰éµçµ„åˆå…ˆå¯«æ­» `Ctrl + Space`ï¼Œæœªä¾†æœ‰éœ€è¦å†åŠ å…¥è¨­å®šåŠŸèƒ½ã€‚

`electron\main.ts`

```ts
// ...

async function createInputWindow() {
  const display = screen.getPrimaryDisplay()

  const newWindow = new BrowserWindow({
    // è¨­ç‚ºè¢å¹•å¯¬åº¦çš„ä¸‰åˆ†ä¹‹ä¸€
    width: display.bounds.width / 3,
    height: 100,
    // ä¸€é–‹å§‹éš±è—è¦–çª—
    show: false,
    // ...
  })

  // ...
}

let mainWindow: BrowserWindow | undefined

app.whenReady().then(async () => {
  mainWindow = await createInputWindow()

  const ret = globalShortcut.register('Ctrl+Space', () => {
    if (!mainWindow)
      return

    if (mainWindow?.isVisible()) {
      mainWindow.hide()
      return
    }

    mainWindow.show()
  })

  if (!ret) {
    console.error('registration failed')
  }
})

app.on('window-all-closed', () => {
  if (process.platform !== 'darwin') {
    app.quit()
  }

  globalShortcut.unregisterAll()
})
```

ç¾åœ¨è®“æˆ‘å€‘æŒ‰æŒ‰çœ‹ `Ctrl + Space`ã€‚

![shortcut-open-window](/cod-toys/shortcut-open-window.gif)

å¯ä»¥çœ‹åˆ°è¦–çª—å‡ºç¾èˆ‡éš±è—äº†ï¼<span class="text-nowrap">âœ§â‘ï½¡Ù©(ËŠá—œË‹*)Ùˆâœ§â•ï½¡</span>

ç¾åœ¨è®“æˆ‘å€‘åŠ ä¸Šä¸€äº›å°ç´°ç¯€ï¼š

- è¦–çª—å¤±å»ç„¦é»æ™‚è‡ªå‹•éš±è—è¦–çª—
- è¦–çª—æœƒå‡ºç¾åœ¨æ»‘é¼ æ‰€åœ¨è¢å¹•ä¸­å¾€ä¸Š 1/3 è™•
- è¦–çª—éš±è—å¾Œï¼Œæœƒè‡ªå‹•å›å¾©ç„¦é»åˆ°åŸæœ¬çš„è¦–çª—ï¼Œé€™æ¨£æ‰å¯ä»¥ç¹¼çºŒè¼¸å…¥

`electron\main.ts`

```ts
// ...

async function createInputWindow() {
  // ...
  newWindow.setMenu(null)

  // å¤±å»ç„¦é»æ™‚è‡ªå‹•éš±è—è¦–çª—
  newWindow.on('blur', () => {
    newWindow.hide()
  })

  // ...
}

app.whenReady().then(async () => {
  mainWindow = await createInputWindow()

  const ret = globalShortcut.register('CmdOrCtrl+Space', () => {
    if (!mainWindow)
      return

    if (mainWindow?.isVisible()) {
      // focusable è¨­ç‚º falseï¼Œæ‰å¯ä»¥è®“ç„¦é»å›åˆ°åŸæœ¬ä½ç½®ã€‚ä¾‹å¦‚æ­£åœ¨è¼¸å…¥çš„ç·¨è¼¯å™¨
      mainWindow.setFocusable(false)
      mainWindow.hide()

      return
    }

    // å–å¾—æ»‘é¼ æ‰€åœ¨è¢å¹•
    const cursorPoint = screen.getCursorScreenPoint()
    const display = screen.getDisplayNearestPoint(cursorPoint)

    // è¨­å®šæ»‘é¼ ä½ç½®ä¹‹è¦–çª—ä¸­é–“å¾€ä¸Š 1/3 çš„ä½ç½®
    const [width, height] = mainWindow.getSize()
    mainWindow?.setPosition(
      Math.floor(display.bounds.x + display.bounds.width / 2 - width / 2),
      Math.floor(display.bounds.y + display.bounds.height / 3 - height / 2),
    )

    mainWindow.setFocusable(true)
    mainWindow.show()
  })

  // ...
})

// ...
```

![auto-refocus](/cod-toys/auto-refocus.gif)

å¯ä»¥æ³¨æ„åˆ°é–‹é—œè¼¸å…¥æ¡†ï¼Œä¸¦ä¸æœƒå½±éŸ¿åŸæœ¬çš„è¼¸å…¥ç„¦é»ã€‚

çœ‹èµ·ä¾†æ˜¯ä¸æ˜¯å¾ˆæœ‰æ¨¡æœ‰æ¨£å•Šï¼<span class="text-nowrap">à©­ Ë™á—œË™ )à©­</span>

## ç¸½çµ ğŸŸ

ä»¥ä¸Šç¨‹å¼ç¢¼å¯ä»¥[åœ¨æ­¤å–å¾—](https://github.com/Codfisher/side-project-cod-toys/tree/feat/global-shortcut)

- ä½¿ç”¨ Electron é–‹ç™¼æ¡Œé¢æ‡‰ç”¨ç¨‹å¼
- `globalShortcut` å¯ä»¥ç¶å®šå…¨åŸŸå¿«æ·éµ

ä¸‹ä¸€ç« è®“æˆ‘å€‘ä¾†å¯¦ä½œå€™é¸åŠŸèƒ½çš„éƒ¨åˆ†å§ã€‚<span class="text-nowrap">â™ª( â—œÏ‰â—Ùˆ(Ùˆ</span>

::: tip
å› ç‚ºç¯‡å¹…å•é¡Œï¼ŒæŸäº›éƒ¨åˆ†ç°¡å–®å¸¶éã€‚

è‹¥æƒ³çœ‹åˆ°æ›´è©³ç´°çš„è§£é‡‹ï¼Œè«‹ä¸åç•™è¨€æˆ–å¯«ä¿¡çµ¦æˆ‘å–”ï¼<span class="text-nowrap">(*Â´âˆ€`)~â™¥</span>
:::
